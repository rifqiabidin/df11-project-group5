{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.2", "generated_at": "2024-01-11T11:40:33.047611Z", "invocation_id": "0046d177-ecdd-4960-a8d8-28b256a0c5aa", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-11T11:40:17.618911Z", "completed_at": "2024-01-11T11:40:17.648909Z"}, {"name": "execute", "started_at": "2024-01-11T11:40:17.653911Z", "completed_at": "2024-01-11T11:40:20.048628Z"}], "thread_id": "Thread-1", "execution_time": 2.4367239475250244, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-southeast2", "project_id": "final-project-df11-group5", "job_id": "5992cd23-a029-419d-ab3f-fa4a6d422a49", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_cloud_run.stg_bank_marketing", "compiled": true, "compiled_code": "with source as (\n\n    select * from `final-project-df11-group5`.`raw_final_project`.`raw_bank_marketing`\n\n),\n\nbase as (\n\n    select\n        `Timestamp` as `timestamp`,\n        Birth_of_Date as birth_of_date,\n        Job as job,\n        Marital as marital,\n        Education as education,\n        `Default` as has_default,\n        Housing as has_housing,\n        Loan as has_loan,\n    from source\n\n)\n\nselect * from base", "relation_name": "`final-project-df11-group5`.`dwh_final_project`.`stg_bank_marketing`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-11T11:40:20.086629Z", "completed_at": "2024-01-11T11:40:20.151627Z"}, {"name": "execute", "started_at": "2024-01-11T11:40:20.155625Z", "completed_at": "2024-01-11T11:40:23.417272Z"}], "thread_id": "Thread-3", "execution_time": 3.3396379947662354, "adapter_response": {"_message": "MERGE (0.0 rows, 5.4 MiB processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 5643789, "bytes_billed": 20971520, "location": "asia-southeast2", "project_id": "final-project-df11-group5", "job_id": "b6a3de1f-7cbd-44ae-ae8d-e552794cefcf", "slot_ms": 701}, "message": "MERGE (0.0 rows, 5.4 MiB processed)", "failures": null, "unique_id": "model.dbt_cloud_run.int_bank_marketing", "compiled": true, "compiled_code": "with updated_stg_bank_marketing as (\n\n    select * from `final-project-df11-group5`.`dwh_final_project`.`stg_bank_marketing`\n    \n    where `timestamp` > (select max(`timestamp`) from `final-project-df11-group5`.`dwh_final_project`.`int_bank_marketing`)\n    \n\n),\n\ntransform as (\n    select * except (\n        birth_of_date),\n        GENERATE_UUID() as id,\n        --md5(`timestamp` || birth_of_date) as id,\n        DATE_DIFF(PARSE_DATE('%d/%m/%Y',FORMAT_DATE('%d/%m/%Y', CURRENT_DATE('Asia/Jakarta'))), birth_of_date, YEAR)  AS age\n    from updated_stg_bank_marketing\n),\n\nbase as (\n    select * except (\n        age, \n        job, \n        education,\n        has_default,\n        has_housing,\n        has_loan\n        ),\n        FORMAT_DATETIME('%Y-%m', `Timestamp`) AS str_join_yearmonth,\n        \n    FLOOR(age / 10) *10\n AS age_group,\n        \n    TRIM(job, '.')\n AS job,\n        \n    CASE\n        WHEN education IN ('basic.4y','basic.6y','basic.9y')\n        THEN 'basic'\n        ELSE education\n END AS cleaned_education,\n        \n    CASE \n        WHEN has_default = 'yes' then '1'\n        WHEN has_default = 'no' then '0'\n        ELSE NULL\n END AS has_default,\n        \n    CASE \n        WHEN has_housing = 'yes' then '1'\n        WHEN has_housing = 'no' then '0'\n        ELSE NULL\n END AS has_housing,\n        \n    CASE \n        WHEN has_loan = 'yes' then '1'\n        WHEN has_loan = 'no' then '0'\n        ELSE NULL\n END AS has_loan\n    from transform\n)\n\nselect * except(cleaned_education, age_group), \nconcat(cast(age_group as string), 's') as age_group,\n\n    REPLACE(cleaned_education, '.', ' ')\n AS education,\nfrom base", "relation_name": "`final-project-df11-group5`.`dwh_final_project`.`int_bank_marketing`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-11T11:40:23.463943Z", "completed_at": "2024-01-11T11:40:23.550665Z"}, {"name": "execute", "started_at": "2024-01-11T11:40:23.567665Z", "completed_at": "2024-01-11T11:40:25.006405Z"}], "thread_id": "Thread-2", "execution_time": 1.5624964237213135, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-southeast2", "project_id": "final-project-df11-group5", "job_id": "f4927882-6150-415d-b3d5-8af92af6ee4c", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_cloud_run.cast_bank_marketing", "compiled": true, "compiled_code": "\n\nwith int_data as (\n\n    select * from `final-project-df11-group5`.`dwh_final_project`.`int_bank_marketing`\n\n), \nbase as (\n    select * except(has_default, has_housing, has_loan, str_join_yearmonth),\n    cast(has_default as INT) as has_default,\n    cast(has_housing as INT) as has_housing,\n    cast(has_loan as INT) as has_loan,\n    cast(str_join_yearmonth as DATE FORMAT 'YYYY-MM') as join_yearmonth\n    from int_data\n)\nselect * from base", "relation_name": "`final-project-df11-group5`.`dwh_final_project`.`cast_bank_marketing`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-11T11:40:23.514666Z", "completed_at": "2024-01-11T11:40:23.582672Z"}, {"name": "execute", "started_at": "2024-01-11T11:40:23.666332Z", "completed_at": "2024-01-11T11:40:26.348257Z"}], "thread_id": "Thread-3", "execution_time": 2.8635897636413574, "adapter_response": {"_message": "CREATE TABLE (12.0 rows, 430.5 KiB processed)", "code": "CREATE TABLE", "rows_affected": 12, "bytes_processed": 440816, "bytes_billed": 10485760, "location": "asia-southeast2", "project_id": "final-project-df11-group5", "job_id": "93f6d1a0-16d6-4e32-816c-96d612dc6104", "slot_ms": 133}, "message": "CREATE TABLE (12.0 rows, 430.5 KiB processed)", "failures": null, "unique_id": "model.dbt_cloud_run.dim_job", "compiled": true, "compiled_code": "select distinct\n    \n\n    case job\n        when 'unknown' then 0\n        when 'housemaid' then 1\n        when 'services' then 2\n        when 'admin' then 3\n        when 'blue-collar' then 4\n        when 'technician' then 5\n        when 'retired' then 6\n        when 'management' then 7\n        when 'unemployed' then 8\n        when 'self-employed' then 9\n        when 'entrepreneur' then 10\n        when 'student' then 11 \n    end\n\n as job_id,\n    job as job_type\nfrom `final-project-df11-group5`.`dwh_final_project`.`int_bank_marketing`\norder by job_id asc", "relation_name": "`final-project-df11-group5`.`dwh_final_project`.`dim_job`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-11T11:40:23.496688Z", "completed_at": "2024-01-11T11:40:23.564667Z"}, {"name": "execute", "started_at": "2024-01-11T11:40:23.597508Z", "completed_at": "2024-01-11T11:40:27.532367Z"}], "thread_id": "Thread-1", "execution_time": 4.079457998275757, "adapter_response": {"_message": "CREATE TABLE (9.0 rows, 201.1 KiB processed)", "code": "CREATE TABLE", "rows_affected": 9, "bytes_processed": 205950, "bytes_billed": 10485760, "location": "asia-southeast2", "project_id": "final-project-df11-group5", "job_id": "dd98a665-6ed3-49e6-8679-dff4c8143ed7", "slot_ms": 128}, "message": "CREATE TABLE (9.0 rows, 201.1 KiB processed)", "failures": null, "unique_id": "model.dbt_cloud_run.dim_age_group", "compiled": true, "compiled_code": "select distinct\n    \n\n    case age_group\n        when '10s' then 1\n        when '20s' then 2\n        when '30s' then 3\n        when '40s' then 4\n        when '50s' then 5\n        when '60s' then 6\n        when '70s' then 7\n        when '80s' then 8\n        when '90s' then 9\n    end\n\n as age_group_id,\n    age_group as age_group\nfrom `final-project-df11-group5`.`dwh_final_project`.`int_bank_marketing`\norder by age_group_id asc", "relation_name": "`final-project-df11-group5`.`dwh_final_project`.`dim_age_group`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-11T11:40:23.533662Z", "completed_at": "2024-01-11T11:40:23.579666Z"}, {"name": "execute", "started_at": "2024-01-11T11:40:23.650273Z", "completed_at": "2024-01-11T11:40:27.601366Z"}], "thread_id": "Thread-4", "execution_time": 4.123406648635864, "adapter_response": {"_message": "CREATE TABLE (6.0 rows, 555.1 KiB processed)", "code": "CREATE TABLE", "rows_affected": 6, "bytes_processed": 568402, "bytes_billed": 10485760, "location": "asia-southeast2", "project_id": "final-project-df11-group5", "job_id": "4f63cdad-14e9-4b4c-ad74-7d41ff4870c3", "slot_ms": 81}, "message": "CREATE TABLE (6.0 rows, 555.1 KiB processed)", "failures": null, "unique_id": "model.dbt_cloud_run.dim_education", "compiled": true, "compiled_code": "select distinct\n    \n\n    case education\n        when 'unknown' then 0\n        when 'basic' then 1\n        when 'high school' then 2\n        when 'professional course' then 3\n        when 'university degree' then 4\n        when 'illiterate' then 5\n    end\n\n as education_id,\n    education as education_type\nfrom `final-project-df11-group5`.`dwh_final_project`.`int_bank_marketing`\norder by education_id asc", "relation_name": "`final-project-df11-group5`.`dwh_final_project`.`dim_education`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-11T11:40:25.031406Z", "completed_at": "2024-01-11T11:40:25.046403Z"}, {"name": "execute", "started_at": "2024-01-11T11:40:25.053415Z", "completed_at": "2024-01-11T11:40:27.789513Z"}], "thread_id": "Thread-2", "execution_time": 2.7694802284240723, "adapter_response": {"_message": "CREATE TABLE (4.0 rows, 355.2 KiB processed)", "code": "CREATE TABLE", "rows_affected": 4, "bytes_processed": 363755, "bytes_billed": 10485760, "location": "asia-southeast2", "project_id": "final-project-df11-group5", "job_id": "1e6cf760-4741-499e-adda-4d1d6415a927", "slot_ms": 259}, "message": "CREATE TABLE (4.0 rows, 355.2 KiB processed)", "failures": null, "unique_id": "model.dbt_cloud_run.dim_marital", "compiled": true, "compiled_code": "select distinct\n    \n\n    case marital\n        when 'unknown' then 0\n        when 'single' then 1\n        when 'married' then 2\n        when 'divorced' then 3\n    end\n\n as marital_id,\n    marital as marital_type\nfrom `final-project-df11-group5`.`dwh_final_project`.`int_bank_marketing`\norder by marital_id asc", "relation_name": "`final-project-df11-group5`.`dwh_final_project`.`dim_marital`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-11T11:40:26.372705Z", "completed_at": "2024-01-11T11:40:26.399059Z"}, {"name": "execute", "started_at": "2024-01-11T11:40:26.403043Z", "completed_at": "2024-01-11T11:40:29.638481Z"}], "thread_id": "Thread-3", "execution_time": 3.275617837905884, "adapter_response": {"_message": "CREATE TABLE (41.2k rows, 3.7 MiB processed)", "code": "CREATE TABLE", "rows_affected": 41190, "bytes_processed": 3853832, "bytes_billed": 10485760, "location": "asia-southeast2", "project_id": "final-project-df11-group5", "job_id": "db9daabf-47e9-48bd-9c44-2015d3f3269d", "slot_ms": 1318}, "message": "CREATE TABLE (41.2k rows, 3.7 MiB processed)", "failures": null, "unique_id": "model.dbt_cloud_run.fact_bank_marketing", "compiled": true, "compiled_code": "with bank_data as (\n\n    select * from `final-project-df11-group5`.`dwh_final_project`.`cast_bank_marketing`\n\n),  \n\nfinal as (\n\n    select \n        id,\n        join_yearmonth,\n        \n\n    case age_group\n        when '10s' then 1\n        when '20s' then 2\n        when '30s' then 3\n        when '40s' then 4\n        when '50s' then 5\n        when '60s' then 6\n        when '70s' then 7\n        when '80s' then 8\n        when '90s' then 9\n    end\n\n as age_group_id,\n        \n\n    case job\n        when 'unknown' then 0\n        when 'housemaid' then 1\n        when 'services' then 2\n        when 'admin' then 3\n        when 'blue-collar' then 4\n        when 'technician' then 5\n        when 'retired' then 6\n        when 'management' then 7\n        when 'unemployed' then 8\n        when 'self-employed' then 9\n        when 'entrepreneur' then 10\n        when 'student' then 11 \n    end\n\n as job_id,\n        \n\n    case education\n        when 'unknown' then 0\n        when 'basic' then 1\n        when 'high school' then 2\n        when 'professional course' then 3\n        when 'university degree' then 4\n        when 'illiterate' then 5\n    end\n\n as education_id,\n        \n\n    case marital\n        when 'unknown' then 0\n        when 'single' then 1\n        when 'married' then 2\n        when 'divorced' then 3\n    end\n\n as marital_id,\n        has_default,\n        has_housing,\n        has_loan\n    from bank_data\n)\n\nselect * from final", "relation_name": "`final-project-df11-group5`.`dwh_final_project`.`fact_bank_marketing`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-11T11:40:29.662479Z", "completed_at": "2024-01-11T11:40:29.680485Z"}, {"name": "execute", "started_at": "2024-01-11T11:40:29.684480Z", "completed_at": "2024-01-11T11:40:33.019612Z"}], "thread_id": "Thread-1", "execution_time": 3.3671281337738037, "adapter_response": {"_message": "CREATE TABLE (41.2k rows, 3.9 MiB processed)", "code": "CREATE TABLE", "rows_affected": 41190, "bytes_processed": 4116764, "bytes_billed": 10485760, "location": "asia-southeast2", "project_id": "final-project-df11-group5", "job_id": "da778c26-a4c7-45fa-911c-369c0ef4f5aa", "slot_ms": 9063}, "message": "CREATE TABLE (41.2k rows, 3.9 MiB processed)", "failures": null, "unique_id": "model.dbt_cloud_run.partclust_fact_bank_marketing", "compiled": true, "compiled_code": "\n\nSELECT * FROM `final-project-df11-group5`.`dwh_final_project`.`fact_bank_marketing`", "relation_name": "`final-project-df11-group5`.`dwh_final_project`.`partclust_fact_bank_marketing`"}], "elapsed_time": 17.251631021499634, "args": {"quiet": false, "send_anonymous_usage_stats": true, "favor_state": false, "indirect_selection": "eager", "log_format": "default", "vars": {}, "warn_error_options": {"include": [], "exclude": []}, "show_resource_report": false, "log_file_max_bytes": 10485760, "log_format_file": "debug", "profiles_dir": "dbt", "which": "run", "select": [], "printer_width": 80, "static_parser": true, "log_level_file": "debug", "invocation_command": "dbt run --project-dir dbt --profiles-dir dbt", "exclude": [], "populate_cache": true, "cache_selected_only": false, "log_path": "dbt\\logs", "partial_parse": true, "use_colors": true, "project_dir": "dbt", "log_level": "info", "defer": false, "print": true, "strict_mode": false, "introspect": true, "enable_legacy_logger": false, "write_json": true, "use_colors_file": true, "macro_debugging": false, "partial_parse_file_diff": true, "version_check": true}}